{"ast":null,"code":"import axios from 'axios';\n\n// Base URL của Django API\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8080/';\n\n// Tạo axios instance\nconst apiClient = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  timeout: 10000 // 10 seconds timeout\n});\n\n// Request interceptor - thêm token vào header\napiClient.interceptors.request.use(config => {\n  const token = localStorage.getItem('access_token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Response interceptor - xử lý lỗi và refresh token\napiClient.interceptors.response.use(response => {\n  return response;\n}, async error => {\n  var _error$response;\n  const originalRequest = error.config;\n\n  // Nếu token hết hạn (401) và chưa retry\n  if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401 && !originalRequest._retry) {\n    originalRequest._retry = true;\n    try {\n      const refreshToken = localStorage.getItem('refresh_token');\n      if (refreshToken) {\n        const response = await axios.post(`${API_BASE_URL}/auth/token/refresh/`, {\n          refresh: refreshToken\n        });\n        const newAccessToken = response.data.access;\n        localStorage.setItem('access_token', newAccessToken);\n\n        // Retry request với token mới\n        originalRequest.headers.Authorization = `Bearer ${newAccessToken}`;\n        return apiClient(originalRequest);\n      }\n    } catch (refreshError) {\n      // Refresh token cũng hết hạn, đăng xuất user\n      localStorage.removeItem('access_token');\n      localStorage.removeItem('refresh_token');\n      window.location.href = '/login';\n      return Promise.reject(refreshError);\n    }\n  }\n  return Promise.reject(error);\n});\nexport default apiClient;\n\n// src/utils/constants.js\nexport const ORDER_STATUS = {\n  PENDING: 'pending',\n  CONFIRMED: 'confirmed',\n  SHIPPING: 'shipping',\n  DELIVERED: 'delivered',\n  CANCELLED: 'cancelled'\n};\nexport const ORDER_STATUS_DISPLAY = {\n  [ORDER_STATUS.PENDING]: 'Chờ xác nhận',\n  [ORDER_STATUS.CONFIRMED]: 'Đã xác nhận',\n  [ORDER_STATUS.SHIPPING]: 'Đang giao hàng',\n  [ORDER_STATUS.DELIVERED]: 'Đã giao hàng',\n  [ORDER_STATUS.CANCELLED]: 'Đã hủy'\n};\nexport const PAYMENT_STATUS = {\n  PENDING: 'pending',\n  PAID: 'paid',\n  FAILED: 'failed'\n};\nexport const USER_TYPES = {\n  BUYER: 'buyer',\n  SELLER: 'seller'\n};\n\n// src/utils/helpers.js\nexport const formatPrice = price => {\n  return new Intl.NumberFormat('vi-VN', {\n    style: 'currency',\n    currency: 'VND'\n  }).format(price);\n};\nexport const formatDate = date => {\n  return new Intl.DateTimeFormat('vi-VN', {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit'\n  }).format(new Date(date));\n};\nexport const truncateText = (text, maxLength = 100) => {\n  if (text.length <= maxLength) return text;\n  return text.substring(0, maxLength) + '...';\n};","map":{"version":3,"names":["axios","API_BASE_URL","process","env","REACT_APP_API_URL","apiClient","create","baseURL","headers","timeout","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","Promise","reject","response","_error$response","originalRequest","status","_retry","refreshToken","post","refresh","newAccessToken","data","access","setItem","refreshError","removeItem","window","location","href","ORDER_STATUS","PENDING","CONFIRMED","SHIPPING","DELIVERED","CANCELLED","ORDER_STATUS_DISPLAY","PAYMENT_STATUS","PAID","FAILED","USER_TYPES","BUYER","SELLER","formatPrice","price","Intl","NumberFormat","style","currency","format","formatDate","date","DateTimeFormat","year","month","day","hour","minute","Date","truncateText","text","maxLength","length","substring"],"sources":["D:/BaitapUIT/Mat_Ma_Hoc/new_final_project_clone/quantum-e-commerce/FE/src/api/client.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Base URL của Django API\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8080/';\r\n\r\n// Tạo axios instance\r\nconst apiClient = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n  timeout: 10000, // 10 seconds timeout\r\n});\r\n\r\n// Request interceptor - thêm token vào header\r\napiClient.interceptors.request.use(\r\n  (config) => {\r\n    const token = localStorage.getItem('access_token');\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Response interceptor - xử lý lỗi và refresh token\r\napiClient.interceptors.response.use(\r\n  (response) => {\r\n    return response;\r\n  },\r\n  async (error) => {\r\n    const originalRequest = error.config;\r\n\r\n    // Nếu token hết hạn (401) và chưa retry\r\n    if (error.response?.status === 401 && !originalRequest._retry) {\r\n      originalRequest._retry = true;\r\n\r\n      try {\r\n        const refreshToken = localStorage.getItem('refresh_token');\r\n        if (refreshToken) {\r\n          const response = await axios.post(`${API_BASE_URL}/auth/token/refresh/`, {\r\n            refresh: refreshToken\r\n          });\r\n          \r\n          const newAccessToken = response.data.access;\r\n          localStorage.setItem('access_token', newAccessToken);\r\n          \r\n          // Retry request với token mới\r\n          originalRequest.headers.Authorization = `Bearer ${newAccessToken}`;\r\n          return apiClient(originalRequest);\r\n        }\r\n      } catch (refreshError) {\r\n        // Refresh token cũng hết hạn, đăng xuất user\r\n        localStorage.removeItem('access_token');\r\n        localStorage.removeItem('refresh_token');\r\n        window.location.href = '/login';\r\n        return Promise.reject(refreshError);\r\n      }\r\n    }\r\n\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default apiClient;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// src/utils/constants.js\r\nexport const ORDER_STATUS = {\r\n  PENDING: 'pending',\r\n  CONFIRMED: 'confirmed',\r\n  SHIPPING: 'shipping', \r\n  DELIVERED: 'delivered',\r\n  CANCELLED: 'cancelled'\r\n};\r\n\r\nexport const ORDER_STATUS_DISPLAY = {\r\n  [ORDER_STATUS.PENDING]: 'Chờ xác nhận',\r\n  [ORDER_STATUS.CONFIRMED]: 'Đã xác nhận',\r\n  [ORDER_STATUS.SHIPPING]: 'Đang giao hàng',\r\n  [ORDER_STATUS.DELIVERED]: 'Đã giao hàng',\r\n  [ORDER_STATUS.CANCELLED]: 'Đã hủy'\r\n};\r\n\r\nexport const PAYMENT_STATUS = {\r\n  PENDING: 'pending',\r\n  PAID: 'paid',\r\n  FAILED: 'failed'\r\n};\r\n\r\nexport const USER_TYPES = {\r\n  BUYER: 'buyer',\r\n  SELLER: 'seller'\r\n};\r\n\r\n// src/utils/helpers.js\r\nexport const formatPrice = (price) => {\r\n  return new Intl.NumberFormat('vi-VN', {\r\n    style: 'currency',\r\n    currency: 'VND'\r\n  }).format(price);\r\n};\r\n\r\nexport const formatDate = (date) => {\r\n  return new Intl.DateTimeFormat('vi-VN', {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit'\r\n  }).format(new Date(date));\r\n};\r\n\r\nexport const truncateText = (text, maxLength = 100) => {\r\n  if (text.length <= maxLength) return text;\r\n  return text.substring(0, maxLength) + '...';\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}