{"ast":null,"code":"import _objectSpread from\"D:/BaitapUIT/Mat_Ma_Hoc/new_final_project_clone/quantum-e-commerce/FE/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/pages/Profile/ProfilePage.jsx\nimport React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{UserIcon,KeyIcon,ShieldCheckIcon,CameraIcon,MapPinIcon,PhoneIcon,EnvelopeIcon}from'@heroicons/react/24/outline';import Sidebar from'../../components/Layout/Sidebar';import Modal from'../../components/Common/Modal';import buyerService from'../../services/buyerService';import sellerService from'../../services/sellerService';import signatureService from'../../services/signatureService';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ProfilePage=()=>{const navigate=useNavigate();const[user,setUser]=useState(null);const[userType,setUserType]=useState(null);const[loading,setLoading]=useState(true);const[editing,setEditing]=useState(false);const[formData,setFormData]=useState({});const[addresses,setAddresses]=useState([]);const[showAddressModal,setShowAddressModal]=useState(false);const[showSignatureModal,setShowSignatureModal]=useState(false);const[editingAddress,setEditingAddress]=useState(null);const[addressForm,setAddressForm]=useState({address:'',phone:'',is_default:false});const[signatureData,setSignatureData]=useState(null);useEffect(()=>{const token=localStorage.getItem('access_token');const type=localStorage.getItem('user_type');if(!token){navigate('/login');return;}setUserType(type);fetchProfile(type);if(type==='buyer'){fetchAddresses();}},[navigate]);const fetchProfile=async type=>{try{setLoading(true);let response;if(type==='buyer'){response=await buyerService.getProfile();}else{response=await sellerService.getProfile();}if(response.success){setUser(response.data);setFormData(response.data);}}catch(error){toast.error('Không thể tải thông tin profile');}finally{setLoading(false);}};const fetchAddresses=async()=>{try{const response=await buyerService.getAddresses();if(response.success){setAddresses(response.data);}}catch(error){console.error('Không thể tải địa chỉ:',error);}};const handleSubmit=async e=>{e.preventDefault();setLoading(true);try{let response;if(userType==='buyer'){response=await buyerService.updateProfile(formData);}else{response=await sellerService.updateProfile(formData);}if(response.success){setUser(response.data);setEditing(false);toast.success('Cập nhật thông tin thành công');// Update localStorage\nlocalStorage.setItem('user_data',JSON.stringify(response.data));}}catch(error){toast.error(error.message||'Không thể cập nhật thông tin');}finally{setLoading(false);}};const handleAddressSubmit=async e=>{e.preventDefault();try{let response;if(editingAddress){response=await buyerService.updateAddress(editingAddress.id,addressForm);}else{response=await buyerService.addAddress(addressForm);}if(response.success){toast.success(editingAddress?'Cập nhật địa chỉ thành công':'Thêm địa chỉ thành công');fetchAddresses();setShowAddressModal(false);setEditingAddress(null);setAddressForm({address:'',phone:'',is_default:false});}}catch(error){toast.error(error.message||'Không thể lưu địa chỉ');}};const handleDeleteAddress=async addressId=>{if(!window.confirm('Bạn có chắc muốn xóa địa chỉ này?'))return;try{await buyerService.deleteAddress(addressId);toast.success('Xóa địa chỉ thành công');fetchAddresses();}catch(error){toast.error('Không thể xóa địa chỉ');}};const handleGenerateSignature=async()=>{// Hiển thị thông báo xác nhận để người dùng hiểu tầm quan trọng\nif(!window.confirm('Bạn sắp tạo một cặp khóa chữ ký số mới. Khóa bí mật sẽ được lưu trên trình duyệt này. Bạn có muốn tiếp tục?')){return;}const toastId=toast.loading('Đang tạo cặp khóa Dilithium...');try{// Thay đổi 1: Gọi đến buyerService thay vì signatureService, vì URL đã được sửa\n// `/api/buyers/{userId}/create-digital-signature/`\nconst response=await buyerService.createDigitalSignature(user.id);if(response.success){// --- BẮT ĐẦU PHẦN CẬP NHẬT GIAO DIỆN VÀ LƯU TRỮ ---\n// Thay đổi 2: Lưu khóa bí mật vào localStorage\n// Cảnh báo: Đây là cách lưu trữ đơn giản, trong thực tế cần mã hóa thêm\nlocalStorage.setItem(\"dilithium_private_key_\".concat(user.id),response.private_key);// Thay đổi 3: Cập nhật state của user ngay lập tức để giao diện thay đổi\n// Dữ liệu mới này được lấy từ chính response của API, không cần phải fetch lại\nconst updatedSignatureInfo={public_key:response.public_key,signature_algorithm:'CRYSTAL-DILITHIUM',dilithium_variant:'DILITHIUM3',is_signature_verified:true,// Giả định là đã xác minh thành công\nquantum_resistant:true};setUser(prevUser=>_objectSpread(_objectSpread({},prevUser),updatedSignatureInfo));// Cũng cập nhật lại formData để nếu người dùng có sửa thông tin khác thì không bị mất\nsetFormData(prevData=>_objectSpread(_objectSpread({},prevData),updatedSignatureInfo));// Cập nhật lại user_data trong localStorage\nconst storedUserData=JSON.parse(localStorage.getItem('user_data'));localStorage.setItem('user_data',JSON.stringify(_objectSpread(_objectSpread({},storedUserData),updatedSignatureInfo)));toast.success('Tạo chữ ký số thành công! Khóa bí mật đã được lưu trữ an toàn trên trình duyệt của bạn.',{id:toastId});// Hiển thị thông tin khóa trong modal\nsetSignatureData({public_key:response.public_key});setShowSignatureModal(true);// --- KẾT THÚC PHẦN CẬP NHẬT ---\n}else{// Nếu API trả về success: false\ntoast.error(response.message||'Không thể tạo chữ ký số',{id:toastId});}}catch(error){toast.error(error.message||'Đã xảy ra lỗi khi tạo chữ ký số',{id:toastId});}};const handleFileUpload=async event=>{const file=event.target.files[0];if(!file)return;// Validate file\nif(!file.type.startsWith('image/')){toast.error('Chỉ được upload hình ảnh');return;}if(file.size>5*1024*1024){// 5MB\ntoast.error('Kích thước file không được vượt quá 5MB');return;}// TODO: Implement actual file upload to server\n// For now, just show success message\ntoast.success('Upload ảnh thành công');};if(loading&&!user){return/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto px-4 py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"animate-pulse\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-8 bg-gray-200 rounded w-1/4 mb-6\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-64 bg-gray-200 rounded\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-8\",children:[/*#__PURE__*/_jsx(Sidebar,{userType:userType}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-6\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"text-2xl font-bold text-gray-800 flex items-center\",children:[/*#__PURE__*/_jsx(UserIcon,{className:\"h-6 w-6 mr-2\"}),userType==='buyer'?'Thông tin cá nhân':'Thông tin Shop']}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditing(!editing),className:editing?'btn-secondary':'btn-primary',disabled:loading,children:editing?'Hủy':'Chỉnh sửa'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden\",children:user!==null&&user!==void 0&&user.avatar?/*#__PURE__*/_jsx(\"img\",{src:user.avatar,alt:\"Avatar\",className:\"w-full h-full object-cover\"}):/*#__PURE__*/_jsx(UserIcon,{className:\"h-12 w-12 text-gray-400\"})}),editing&&/*#__PURE__*/_jsxs(\"label\",{className:\"absolute bottom-0 right-0 bg-primary text-white p-1 rounded-full cursor-pointer hover:bg-secondary\",children:[/*#__PURE__*/_jsx(CameraIcon,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleFileUpload,className:\"hidden\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold\",children:(user===null||user===void 0?void 0:user[userType==='buyer'?'full_name':'shop_name'])||(user===null||user===void 0?void 0:user.username)}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:userType==='buyer'?'Người mua':(user===null||user===void 0?void 0:user.shop_type)==='shopee_mall'?'Shopee Mall':'Shop thường'})]})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(EnvelopeIcon,{className:\"h-4 w-4 inline mr-1\"}),\"T\\xEAn \\u0111\\u0103ng nh\\u1EADp\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.username||'',className:\"input-field bg-gray-100\",disabled:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(EnvelopeIcon,{className:\"h-4 w-4 inline mr-1\"}),\"Email\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:formData.email||'',className:\"input-field bg-gray-100 flex-1\",disabled:true}),user!==null&&user!==void 0&&user.email_verified?/*#__PURE__*/_jsx(ShieldCheckIcon,{className:\"h-5 w-5 text-green-500 ml-2\",title:\"Email \\u0111\\xE3 x\\xE1c minh\"}):/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ml-2 text-xs text-primary hover:text-secondary\",children:\"X\\xE1c minh\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(UserIcon,{className:\"h-4 w-4 inline mr-1\"}),userType==='buyer'?'Họ và tên':'Tên Shop']}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData[userType==='buyer'?'full_name':'shop_name']||'',onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{[userType==='buyer'?'full_name':'shop_name']:e.target.value})),className:\"input-field\",disabled:!editing,placeholder:userType==='buyer'?'Nhập họ và tên':'Nhập tên shop'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(PhoneIcon,{className:\"h-4 w-4 inline mr-1\"}),\"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:formData.phone||'',onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{phone:e.target.value})),className:\"input-field flex-1\",disabled:!editing,placeholder:\"Nh\\u1EADp s\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"}),user!==null&&user!==void 0&&user.phone_verified?/*#__PURE__*/_jsx(ShieldCheckIcon,{className:\"h-5 w-5 text-green-500 ml-2\",title:\"S\\u0110T \\u0111\\xE3 x\\xE1c minh\"}):(user===null||user===void 0?void 0:user.phone)&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"ml-2 text-xs text-primary hover:text-secondary\",children:\"X\\xE1c minh\"})]})]}),userType==='seller'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Lo\\u1EA1i Shop\"}),/*#__PURE__*/_jsxs(\"select\",{value:formData.shop_type||'normal',onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{shop_type:e.target.value})),className:\"input-field\",disabled:!editing||(user===null||user===void 0?void 0:user.shop_type)==='shopee_mall',children:[/*#__PURE__*/_jsx(\"option\",{value:\"normal\",children:\"Shop th\\u01B0\\u1EDDng\"}),/*#__PURE__*/_jsx(\"option\",{value:\"shopee_mall\",children:\"Shopee Mall\"})]}),(user===null||user===void 0?void 0:user.shop_type)==='shopee_mall'&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-green-600 mt-1\",children:\"\\u2705 Shop \\u0111\\xE3 \\u0111\\u01B0\\u1EE3c x\\xE1c minh Shopee Mall\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"M\\xF4 t\\u1EA3 Shop\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.description||'',onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{description:e.target.value})),rows:3,className:\"input-field\",disabled:!editing,placeholder:\"M\\xF4 t\\u1EA3 v\\u1EC1 shop c\\u1EE7a b\\u1EA1n...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(MapPinIcon,{className:\"h-4 w-4 inline mr-1\"}),\"\\u0110\\u1ECBa ch\\u1EC9 Shop\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.address||'',onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{address:e.target.value})),className:\"input-field\",disabled:!editing,placeholder:\"Nh\\u1EADp \\u0111\\u1ECBa ch\\u1EC9 shop\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"M\\xE3 s\\u1ED1 thu\\u1EBF\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.tax_code||'',onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{tax_code:e.target.value})),className:\"input-field\",disabled:!editing,placeholder:\"Nh\\u1EADp m\\xE3 s\\u1ED1 thu\\u1EBF\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Ng\\u01B0\\u1EDDi \\u0111\\u1EA1i di\\u1EC7n ph\\xE1p lu\\u1EADt\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.legal_representative||'',onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{legal_representative:e.target.value})),className:\"input-field\",disabled:!editing,placeholder:\"Nh\\u1EADp t\\xEAn ng\\u01B0\\u1EDDi \\u0111\\u1EA1i di\\u1EC7n\"})]})]})]}),editing&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 flex space-x-4\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loading,className:\"btn-primary disabled:opacity-50\",children:loading?'Đang lưu...':'Lưu thay đổi'})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-6\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-lg font-semibold mb-4 flex items-center\",children:[/*#__PURE__*/_jsx(KeyIcon,{className:\"h-5 w-5 mr-2\"}),\"Ch\\u1EEF k\\xFD s\\u1ED1 Dilithium\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 rounded-lg p-4 border border-blue-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"inline-block w-3 h-3 rounded-full mr-3 \".concat(user!==null&&user!==void 0&&user.is_signature_verified?'bg-green-500':'bg-yellow-500')}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-blue-800\",children:user!==null&&user!==void 0&&user.is_signature_verified?'Đã thiết lập chữ ký số':'Chưa thiết lập chữ ký số'}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-blue-600\",children:(user===null||user===void 0?void 0:user.signature_algorithm)&&/*#__PURE__*/_jsxs(\"span\",{children:[\"Thu\\u1EADt to\\xE1n: \",user.signature_algorithm,\" \",user.dilithium_variant]})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-2\",children:!(user!==null&&user!==void 0&&user.is_signature_verified)?/*#__PURE__*/_jsx(\"button\",{onClick:handleGenerateSignature,disabled:loading,className:\"btn-primary text-sm disabled:opacity-50\",children:loading?'Đang tạo...':'Tạo chữ ký số'}):/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowSignatureModal(true),className:\"btn-secondary text-sm\",children:\"Xem chi ti\\u1EBFt\"})})]}),(user===null||user===void 0?void 0:user.quantum_resistant)&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 text-xs text-green-700\",children:\"\\u2705 Ch\\u1EEF k\\xFD s\\u1ED1 kh\\xE1ng l\\u01B0\\u1EE3ng t\\u1EED (Post-Quantum Cryptography)\"})]})]}),userType==='buyer'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-lg font-semibold flex items-center\",children:[/*#__PURE__*/_jsx(MapPinIcon,{className:\"h-5 w-5 mr-2\"}),\"\\u0110\\u1ECBa ch\\u1EC9 c\\u1EE7a t\\xF4i\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowAddressModal(true),className:\"btn-primary text-sm\",children:\"Th\\xEAm \\u0111\\u1ECBa ch\\u1EC9 m\\u1EDBi\"})]}),addresses.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-gray-500\",children:[/*#__PURE__*/_jsx(MapPinIcon,{className:\"h-12 w-12 mx-auto mb-2 text-gray-300\"}),/*#__PURE__*/_jsx(\"p\",{children:\"B\\u1EA1n ch\\u01B0a c\\xF3 \\u0111\\u1ECBa ch\\u1EC9 n\\xE0o\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:addresses.map(address=>/*#__PURE__*/_jsx(\"div\",{className:\"border rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:address.phone}),address.is_default&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 px-2 py-1 bg-primary text-white text-xs rounded\",children:\"M\\u1EB7c \\u0111\\u1ECBnh\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm\",children:address.address})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2 ml-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setEditingAddress(address);setAddressForm(address);setShowAddressModal(true);},className:\"text-primary hover:text-secondary text-sm\",children:\"S\\u1EEDa\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteAddress(address.id),className:\"text-red-500 hover:text-red-700 text-sm\",children:\"X\\xF3a\"})]})]})},address.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold mb-4\",children:\"Th\\u1ED1ng k\\xEA t\\xE0i kho\\u1EA3n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-primary\",children:userType==='seller'?(user===null||user===void 0?void 0:user.total_products)||0:'12'}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:userType==='seller'?'Sản phẩm':'Đơn hàng'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-green-600\",children:userType==='seller'?(user===null||user===void 0?void 0:user.total_sold)||0:'8'}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:userType==='seller'?'Đã bán':'Hoàn thành'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-yellow-600\",children:(user===null||user===void 0?void 0:user.rating)||'0.0'}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"\\u0110\\xE1nh gi\\xE1\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-blue-600\",children:Math.floor((new Date()-new Date(user===null||user===void 0?void 0:user.created_at))/(1000*60*60*24))||0}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-500\",children:\"Ng\\xE0y tham gia\"})]})]})]})]})]}),/*#__PURE__*/_jsx(Modal,{isOpen:showAddressModal,onClose:()=>{setShowAddressModal(false);setEditingAddress(null);setAddressForm({address:'',phone:'',is_default:false});},title:editingAddress?'Sửa địa chỉ':'Thêm địa chỉ mới',children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAddressSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"\\u0110\\u1ECBa ch\\u1EC9 *\"}),/*#__PURE__*/_jsx(\"textarea\",{required:true,value:addressForm.address,onChange:e=>setAddressForm(_objectSpread(_objectSpread({},addressForm),{},{address:e.target.value})),rows:3,className:\"input-field\",placeholder:\"Nh\\u1EADp \\u0111\\u1ECBa ch\\u1EC9 \\u0111\\u1EA7y \\u0111\\u1EE7...\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",required:true,value:addressForm.phone,onChange:e=>setAddressForm(_objectSpread(_objectSpread({},addressForm),{},{phone:e.target.value})),className:\"input-field\",placeholder:\"Nh\\u1EADp s\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"is_default\",checked:addressForm.is_default,onChange:e=>setAddressForm(_objectSpread(_objectSpread({},addressForm),{},{is_default:e.target.checked})),className:\"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"is_default\",className:\"ml-2 text-sm text-gray-700\",children:\"\\u0110\\u1EB7t l\\xE0m \\u0111\\u1ECBa ch\\u1EC9 m\\u1EB7c \\u0111\\u1ECBnh\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3 pt-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary flex-1\",children:editingAddress?'Cập nhật':'Thêm địa chỉ'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowAddressModal(false),className:\"btn-secondary flex-1\",children:\"H\\u1EE7y\"})]})]})}),/*#__PURE__*/_jsx(Modal,{isOpen:showSignatureModal,onClose:()=>setShowSignatureModal(false),title:\"Chi ti\\u1EBFt ch\\u1EEF k\\xFD s\\u1ED1 Dilithium\",size:\"large\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-50 border border-green-200 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-green-800 mb-2\",children:\"\\u2705 Ch\\u1EEF k\\xFD s\\u1ED1 \\u0111\\xE3 \\u0111\\u01B0\\u1EE3c thi\\u1EBFt l\\u1EADp\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-green-700 space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Thu\\u1EADt to\\xE1n: \",user===null||user===void 0?void 0:user.signature_algorithm]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Variant: \",user===null||user===void 0?void 0:user.dilithium_variant]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Kh\\xE1ng l\\u01B0\\u1EE3ng t\\u1EED: \",user!==null&&user!==void 0&&user.quantum_resistant?'Có':'Không']}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Tr\\u1EA1ng th\\xE1i: \",user!==null&&user!==void 0&&user.is_signature_verified?'Đã xác minh':'Chưa xác minh']})]})]}),signatureData&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Public Key (Kh\\xF3a c\\xF4ng khai)\"}),/*#__PURE__*/_jsx(\"textarea\",{value:signatureData.public_key,readOnly:true,rows:4,className:\"input-field font-mono text-xs bg-gray-50\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"font-semibold text-yellow-800 mb-2\",children:\"\\u26A0\\uFE0F L\\u01B0u \\xFD quan tr\\u1ECDng\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-sm text-yellow-700 space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Private key \\u0111\\xE3 \\u0111\\u01B0\\u1EE3c m\\xE3 h\\xF3a v\\xE0 l\\u01B0u tr\\u1EEF an to\\xE0n\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Kh\\xF4ng chia s\\u1EBB private key v\\u1EDBi b\\u1EA5t k\\u1EF3 ai\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Sao l\\u01B0u kh\\xF3a ri\\xEAng \\u1EDF n\\u01A1i an to\\xE0n\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Ch\\u1EEF k\\xFD s\\u1ED1 n\\xE0y s\\u1EBD \\u0111\\u01B0\\u1EE3c d\\xF9ng \\u0111\\u1EC3 x\\xE1c th\\u1EF1c c\\xE1c giao d\\u1ECBch\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowSignatureModal(false),className:\"btn-primary\",children:\"\\u0110\\xF3ng\"})})]})})]});};export default ProfilePage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","UserIcon","KeyIcon","ShieldCheckIcon","CameraIcon","MapPinIcon","PhoneIcon","EnvelopeIcon","Sidebar","Modal","buyerService","sellerService","signatureService","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ProfilePage","navigate","user","setUser","userType","setUserType","loading","setLoading","editing","setEditing","formData","setFormData","addresses","setAddresses","showAddressModal","setShowAddressModal","showSignatureModal","setShowSignatureModal","editingAddress","setEditingAddress","addressForm","setAddressForm","address","phone","is_default","signatureData","setSignatureData","token","localStorage","getItem","type","fetchProfile","fetchAddresses","response","getProfile","success","data","error","getAddresses","console","handleSubmit","e","preventDefault","updateProfile","setItem","JSON","stringify","message","handleAddressSubmit","updateAddress","id","addAddress","handleDeleteAddress","addressId","window","confirm","deleteAddress","handleGenerateSignature","toastId","createDigitalSignature","concat","private_key","updatedSignatureInfo","public_key","signature_algorithm","dilithium_variant","is_signature_verified","quantum_resistant","prevUser","_objectSpread","prevData","storedUserData","parse","handleFileUpload","event","file","target","files","startsWith","size","className","children","onClick","disabled","avatar","src","alt","accept","onChange","username","shop_type","onSubmit","value","email","email_verified","title","placeholder","phone_verified","description","rows","tax_code","legal_representative","length","map","total_products","total_sold","rating","Math","floor","Date","created_at","isOpen","onClose","required","checked","htmlFor","readOnly"],"sources":["D:/BaitapUIT/Mat_Ma_Hoc/new_final_project_clone/quantum-e-commerce/FE/src/pages/Profile/ProfilePage.jsx"],"sourcesContent":["// src/pages/Profile/ProfilePage.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { \r\n  UserIcon, \r\n  KeyIcon, \r\n  ShieldCheckIcon,\r\n  CameraIcon,\r\n  MapPinIcon,\r\n  PhoneIcon,\r\n  EnvelopeIcon \r\n} from '@heroicons/react/24/outline';\r\nimport Sidebar from '../../components/Layout/Sidebar';\r\nimport Modal from '../../components/Common/Modal';\r\nimport buyerService from '../../services/buyerService';\r\nimport sellerService from '../../services/sellerService';\r\nimport signatureService from '../../services/signatureService';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst ProfilePage = () => {\r\n  const navigate = useNavigate();\r\n  const [user, setUser] = useState(null);\r\n  const [userType, setUserType] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [editing, setEditing] = useState(false);\r\n  const [formData, setFormData] = useState({});\r\n  const [addresses, setAddresses] = useState([]);\r\n  const [showAddressModal, setShowAddressModal] = useState(false);\r\n  const [showSignatureModal, setShowSignatureModal] = useState(false);\r\n  const [editingAddress, setEditingAddress] = useState(null);\r\n  const [addressForm, setAddressForm] = useState({\r\n    address: '',\r\n    phone: '',\r\n    is_default: false\r\n  });\r\n  const [signatureData, setSignatureData] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('access_token');\r\n    const type = localStorage.getItem('user_type');\r\n    \r\n    if (!token) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n    \r\n    setUserType(type);\r\n    fetchProfile(type);\r\n    if (type === 'buyer') {\r\n      fetchAddresses();\r\n    }\r\n  }, [navigate]);\r\n\r\n  const fetchProfile = async (type) => {\r\n    try {\r\n      setLoading(true);\r\n      let response;\r\n      \r\n      if (type === 'buyer') {\r\n        response = await buyerService.getProfile();\r\n      } else {\r\n        response = await sellerService.getProfile();\r\n      }\r\n      \r\n      if (response.success) {\r\n        setUser(response.data);\r\n        setFormData(response.data);\r\n      }\r\n    } catch (error) {\r\n      toast.error('Không thể tải thông tin profile');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchAddresses = async () => {\r\n    try {\r\n      const response = await buyerService.getAddresses();\r\n      if (response.success) {\r\n        setAddresses(response.data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Không thể tải địa chỉ:', error);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      let response;\r\n      \r\n      if (userType === 'buyer') {\r\n        response = await buyerService.updateProfile(formData);\r\n      } else {\r\n        response = await sellerService.updateProfile(formData);\r\n      }\r\n      \r\n      if (response.success) {\r\n        setUser(response.data);\r\n        setEditing(false);\r\n        toast.success('Cập nhật thông tin thành công');\r\n        \r\n        // Update localStorage\r\n        localStorage.setItem('user_data', JSON.stringify(response.data));\r\n      }\r\n    } catch (error) {\r\n      toast.error(error.message || 'Không thể cập nhật thông tin');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleAddressSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    try {\r\n      let response;\r\n      if (editingAddress) {\r\n        response = await buyerService.updateAddress(editingAddress.id, addressForm);\r\n      } else {\r\n        response = await buyerService.addAddress(addressForm);\r\n      }\r\n      \r\n      if (response.success) {\r\n        toast.success(editingAddress ? 'Cập nhật địa chỉ thành công' : 'Thêm địa chỉ thành công');\r\n        fetchAddresses();\r\n        setShowAddressModal(false);\r\n        setEditingAddress(null);\r\n        setAddressForm({ address: '', phone: '', is_default: false });\r\n      }\r\n    } catch (error) {\r\n      toast.error(error.message || 'Không thể lưu địa chỉ');\r\n    }\r\n  };\r\n\r\n  const handleDeleteAddress = async (addressId) => {\r\n    if (!window.confirm('Bạn có chắc muốn xóa địa chỉ này?')) return;\r\n    \r\n    try {\r\n      await buyerService.deleteAddress(addressId);\r\n      toast.success('Xóa địa chỉ thành công');\r\n      fetchAddresses();\r\n    } catch (error) {\r\n      toast.error('Không thể xóa địa chỉ');\r\n    }\r\n  };\r\n\r\n  const handleGenerateSignature = async () => {\r\n    // Hiển thị thông báo xác nhận để người dùng hiểu tầm quan trọng\r\n    if (!window.confirm('Bạn sắp tạo một cặp khóa chữ ký số mới. Khóa bí mật sẽ được lưu trên trình duyệt này. Bạn có muốn tiếp tục?')) {\r\n      return;\r\n    }\r\n\r\n    const toastId = toast.loading('Đang tạo cặp khóa Dilithium...');\r\n    \r\n    try {\r\n      // Thay đổi 1: Gọi đến buyerService thay vì signatureService, vì URL đã được sửa\r\n      // `/api/buyers/{userId}/create-digital-signature/`\r\n      const response = await buyerService.createDigitalSignature(user.id);\r\n\r\n      if (response.success) {\r\n        // --- BẮT ĐẦU PHẦN CẬP NHẬT GIAO DIỆN VÀ LƯU TRỮ ---\r\n\r\n        // Thay đổi 2: Lưu khóa bí mật vào localStorage\r\n        // Cảnh báo: Đây là cách lưu trữ đơn giản, trong thực tế cần mã hóa thêm\r\n        localStorage.setItem(`dilithium_private_key_${user.id}`, response.private_key);\r\n\r\n        // Thay đổi 3: Cập nhật state của user ngay lập tức để giao diện thay đổi\r\n        // Dữ liệu mới này được lấy từ chính response của API, không cần phải fetch lại\r\n        const updatedSignatureInfo = {\r\n          public_key: response.public_key,\r\n          signature_algorithm: 'CRYSTAL-DILITHIUM',\r\n          dilithium_variant: 'DILITHIUM3',\r\n          is_signature_verified: true, // Giả định là đã xác minh thành công\r\n          quantum_resistant: true,\r\n        };\r\n\r\n        setUser(prevUser => ({\r\n          ...prevUser,\r\n          ...updatedSignatureInfo\r\n        }));\r\n\r\n        // Cũng cập nhật lại formData để nếu người dùng có sửa thông tin khác thì không bị mất\r\n        setFormData(prevData => ({\r\n          ...prevData,\r\n          ...updatedSignatureInfo\r\n        }));\r\n        \r\n        // Cập nhật lại user_data trong localStorage\r\n        const storedUserData = JSON.parse(localStorage.getItem('user_data'));\r\n        localStorage.setItem('user_data', JSON.stringify({ ...storedUserData, ...updatedSignatureInfo }));\r\n\r\n        toast.success('Tạo chữ ký số thành công! Khóa bí mật đã được lưu trữ an toàn trên trình duyệt của bạn.', { id: toastId });\r\n        \r\n        // Hiển thị thông tin khóa trong modal\r\n        setSignatureData({ public_key: response.public_key });\r\n        setShowSignatureModal(true);\r\n        \r\n        // --- KẾT THÚC PHẦN CẬP NHẬT ---\r\n      } else {\r\n        // Nếu API trả về success: false\r\n        toast.error(response.message || 'Không thể tạo chữ ký số', { id: toastId });\r\n      }\r\n    } catch (error) {\r\n      toast.error(error.message || 'Đã xảy ra lỗi khi tạo chữ ký số', { id: toastId });\r\n    }\r\n  };\r\n\r\n  const handleFileUpload = async (event) => {\r\n    const file = event.target.files[0];\r\n    if (!file) return;\r\n\r\n    // Validate file\r\n    if (!file.type.startsWith('image/')) {\r\n      toast.error('Chỉ được upload hình ảnh');\r\n      return;\r\n    }\r\n\r\n    if (file.size > 5 * 1024 * 1024) { // 5MB\r\n      toast.error('Kích thước file không được vượt quá 5MB');\r\n      return;\r\n    }\r\n\r\n    // TODO: Implement actual file upload to server\r\n    // For now, just show success message\r\n    toast.success('Upload ảnh thành công');\r\n  };\r\n\r\n  if (loading && !user) {\r\n    return (\r\n      <div className=\"container mx-auto px-4 py-8\">\r\n        <div className=\"animate-pulse\">\r\n          <div className=\"h-8 bg-gray-200 rounded w-1/4 mb-6\"></div>\r\n          <div className=\"h-64 bg-gray-200 rounded\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-8\">\r\n      <div className=\"flex gap-8\">\r\n        <Sidebar userType={userType} />\r\n        \r\n        <div className=\"flex-1 space-y-6\">\r\n          {/* Profile Info */}\r\n          <div className=\"bg-white rounded-lg shadow p-6\">\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n              <h1 className=\"text-2xl font-bold text-gray-800 flex items-center\">\r\n                <UserIcon className=\"h-6 w-6 mr-2\" />\r\n                {userType === 'buyer' ? 'Thông tin cá nhân' : 'Thông tin Shop'}\r\n              </h1>\r\n              <button\r\n                onClick={() => setEditing(!editing)}\r\n                className={editing ? 'btn-secondary' : 'btn-primary'}\r\n                disabled={loading}\r\n              >\r\n                {editing ? 'Hủy' : 'Chỉnh sửa'}\r\n              </button>\r\n            </div>\r\n\r\n            {/* Avatar Section */}\r\n            <div className=\"flex items-center mb-6\">\r\n              <div className=\"relative\">\r\n                <div className=\"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden\">\r\n                  {user?.avatar ? (\r\n                    <img src={user.avatar} alt=\"Avatar\" className=\"w-full h-full object-cover\" />\r\n                  ) : (\r\n                    <UserIcon className=\"h-12 w-12 text-gray-400\" />\r\n                  )}\r\n                </div>\r\n                {editing && (\r\n                  <label className=\"absolute bottom-0 right-0 bg-primary text-white p-1 rounded-full cursor-pointer hover:bg-secondary\">\r\n                    <CameraIcon className=\"h-4 w-4\" />\r\n                    <input\r\n                      type=\"file\"\r\n                      accept=\"image/*\"\r\n                      onChange={handleFileUpload}\r\n                      className=\"hidden\"\r\n                    />\r\n                  </label>\r\n                )}\r\n              </div>\r\n              <div className=\"ml-4\">\r\n                <h3 className=\"text-lg font-semibold\">\r\n                  {user?.[userType === 'buyer' ? 'full_name' : 'shop_name'] || user?.username}\r\n                </h3>\r\n                <p className=\"text-gray-500\">\r\n                  {userType === 'buyer' ? 'Người mua' : user?.shop_type === 'shopee_mall' ? 'Shopee Mall' : 'Shop thường'}\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            <form onSubmit={handleSubmit}>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    <EnvelopeIcon className=\"h-4 w-4 inline mr-1\" />\r\n                    Tên đăng nhập\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={formData.username || ''}\r\n                    className=\"input-field bg-gray-100\"\r\n                    disabled\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    <EnvelopeIcon className=\"h-4 w-4 inline mr-1\" />\r\n                    Email\r\n                  </label>\r\n                  <div className=\"flex items-center\">\r\n                    <input\r\n                      type=\"email\"\r\n                      value={formData.email || ''}\r\n                      className=\"input-field bg-gray-100 flex-1\"\r\n                      disabled\r\n                    />\r\n                    {user?.email_verified ? (\r\n                      <ShieldCheckIcon className=\"h-5 w-5 text-green-500 ml-2\" title=\"Email đã xác minh\" />\r\n                    ) : (\r\n                      <button\r\n                        type=\"button\"\r\n                        className=\"ml-2 text-xs text-primary hover:text-secondary\"\r\n                      >\r\n                        Xác minh\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    <UserIcon className=\"h-4 w-4 inline mr-1\" />\r\n                    {userType === 'buyer' ? 'Họ và tên' : 'Tên Shop'}\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={formData[userType === 'buyer' ? 'full_name' : 'shop_name'] || ''}\r\n                    onChange={(e) => setFormData({\r\n                      ...formData,\r\n                      [userType === 'buyer' ? 'full_name' : 'shop_name']: e.target.value\r\n                    })}\r\n                    className=\"input-field\"\r\n                    disabled={!editing}\r\n                    placeholder={userType === 'buyer' ? 'Nhập họ và tên' : 'Nhập tên shop'}\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    <PhoneIcon className=\"h-4 w-4 inline mr-1\" />\r\n                    Số điện thoại\r\n                  </label>\r\n                  <div className=\"flex items-center\">\r\n                    <input\r\n                      type=\"tel\"\r\n                      value={formData.phone || ''}\r\n                      onChange={(e) => setFormData({...formData, phone: e.target.value})}\r\n                      className=\"input-field flex-1\"\r\n                      disabled={!editing}\r\n                      placeholder=\"Nhập số điện thoại\"\r\n                    />\r\n                    {user?.phone_verified ? (\r\n                      <ShieldCheckIcon className=\"h-5 w-5 text-green-500 ml-2\" title=\"SĐT đã xác minh\" />\r\n                    ) : (\r\n                      user?.phone && (\r\n                        <button\r\n                          type=\"button\"\r\n                          className=\"ml-2 text-xs text-primary hover:text-secondary\"\r\n                        >\r\n                          Xác minh\r\n                        </button>\r\n                      )\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                {userType === 'seller' && (\r\n                  <>\r\n                    <div className=\"md:col-span-2\">\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                        Loại Shop\r\n                      </label>\r\n                      <select\r\n                        value={formData.shop_type || 'normal'}\r\n                        onChange={(e) => setFormData({...formData, shop_type: e.target.value})}\r\n                        className=\"input-field\"\r\n                        disabled={!editing || user?.shop_type === 'shopee_mall'}\r\n                      >\r\n                        <option value=\"normal\">Shop thường</option>\r\n                        <option value=\"shopee_mall\">Shopee Mall</option>\r\n                      </select>\r\n                      {user?.shop_type === 'shopee_mall' && (\r\n                        <p className=\"text-xs text-green-600 mt-1\">\r\n                          ✅ Shop đã được xác minh Shopee Mall\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"md:col-span-2\">\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                        Mô tả Shop\r\n                      </label>\r\n                      <textarea\r\n                        value={formData.description || ''}\r\n                        onChange={(e) => setFormData({...formData, description: e.target.value})}\r\n                        rows={3}\r\n                        className=\"input-field\"\r\n                        disabled={!editing}\r\n                        placeholder=\"Mô tả về shop của bạn...\"\r\n                      />\r\n                    </div>\r\n\r\n                    <div className=\"md:col-span-2\">\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                        <MapPinIcon className=\"h-4 w-4 inline mr-1\" />\r\n                        Địa chỉ Shop\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={formData.address || ''}\r\n                        onChange={(e) => setFormData({...formData, address: e.target.value})}\r\n                        className=\"input-field\"\r\n                        disabled={!editing}\r\n                        placeholder=\"Nhập địa chỉ shop\"\r\n                      />\r\n                    </div>\r\n\r\n                    {/* Business Info for Sellers */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                        Mã số thuế\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={formData.tax_code || ''}\r\n                        onChange={(e) => setFormData({...formData, tax_code: e.target.value})}\r\n                        className=\"input-field\"\r\n                        disabled={!editing}\r\n                        placeholder=\"Nhập mã số thuế\"\r\n                      />\r\n                    </div>\r\n\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                        Người đại diện pháp luật\r\n                      </label>\r\n                      <input\r\n                        type=\"text\"\r\n                        value={formData.legal_representative || ''}\r\n                        onChange={(e) => setFormData({...formData, legal_representative: e.target.value})}\r\n                        className=\"input-field\"\r\n                        disabled={!editing}\r\n                        placeholder=\"Nhập tên người đại diện\"\r\n                      />\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </div>\r\n\r\n              {editing && (\r\n                <div className=\"mt-6 flex space-x-4\">\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={loading}\r\n                    className=\"btn-primary disabled:opacity-50\"\r\n                  >\r\n                    {loading ? 'Đang lưu...' : 'Lưu thay đổi'}\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </form>\r\n          </div>\r\n\r\n          {/* Digital Signature Section */}\r\n          <div className=\"bg-white rounded-lg shadow p-6\">\r\n            <h2 className=\"text-lg font-semibold mb-4 flex items-center\">\r\n              <KeyIcon className=\"h-5 w-5 mr-2\" />\r\n              Chữ ký số Dilithium\r\n            </h2>\r\n            \r\n            <div className=\"bg-blue-50 rounded-lg p-4 border border-blue-200\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center\">\r\n                  <span className={`inline-block w-3 h-3 rounded-full mr-3 ${\r\n                    user?.is_signature_verified ? 'bg-green-500' : 'bg-yellow-500'\r\n                  }`}></span>\r\n                  <div>\r\n                    <div className=\"font-medium text-blue-800\">\r\n                      {user?.is_signature_verified ? 'Đã thiết lập chữ ký số' : 'Chưa thiết lập chữ ký số'}\r\n                    </div>\r\n                    <div className=\"text-sm text-blue-600\">\r\n                      {user?.signature_algorithm && (\r\n                        <span>Thuật toán: {user.signature_algorithm} {user.dilithium_variant}</span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"flex space-x-2\">\r\n                  {!user?.is_signature_verified ? (\r\n                    <button\r\n                      onClick={handleGenerateSignature}\r\n                      disabled={loading}\r\n                      className=\"btn-primary text-sm disabled:opacity-50\"\r\n                    >\r\n                      {loading ? 'Đang tạo...' : 'Tạo chữ ký số'}\r\n                    </button>\r\n                  ) : (\r\n                    <button\r\n                      onClick={() => setShowSignatureModal(true)}\r\n                      className=\"btn-secondary text-sm\"\r\n                    >\r\n                      Xem chi tiết\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              \r\n              {user?.quantum_resistant && (\r\n                <div className=\"mt-2 text-xs text-green-700\">\r\n                  ✅ Chữ ký số kháng lượng tử (Post-Quantum Cryptography)\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Addresses Section (Only for Buyers) */}\r\n          {userType === 'buyer' && (\r\n            <div className=\"bg-white rounded-lg shadow p-6\">\r\n              <div className=\"flex justify-between items-center mb-4\">\r\n                <h2 className=\"text-lg font-semibold flex items-center\">\r\n                  <MapPinIcon className=\"h-5 w-5 mr-2\" />\r\n                  Địa chỉ của tôi\r\n                </h2>\r\n                <button\r\n                  onClick={() => setShowAddressModal(true)}\r\n                  className=\"btn-primary text-sm\"\r\n                >\r\n                  Thêm địa chỉ mới\r\n                </button>\r\n              </div>\r\n\r\n              {addresses.length === 0 ? (\r\n                <div className=\"text-center py-8 text-gray-500\">\r\n                  <MapPinIcon className=\"h-12 w-12 mx-auto mb-2 text-gray-300\" />\r\n                  <p>Bạn chưa có địa chỉ nào</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-3\">\r\n                  {addresses.map((address) => (\r\n                    <div key={address.id} className=\"border rounded-lg p-4\">\r\n                      <div className=\"flex justify-between items-start\">\r\n                        <div className=\"flex-1\">\r\n                          <div className=\"flex items-center mb-2\">\r\n                            <span className=\"font-medium\">{address.phone}</span>\r\n                            {address.is_default && (\r\n                              <span className=\"ml-2 px-2 py-1 bg-primary text-white text-xs rounded\">\r\n                                Mặc định\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                          <p className=\"text-gray-600 text-sm\">{address.address}</p>\r\n                        </div>\r\n                        \r\n                        <div className=\"flex space-x-2 ml-4\">\r\n                          <button\r\n                            onClick={() => {\r\n                              setEditingAddress(address);\r\n                              setAddressForm(address);\r\n                              setShowAddressModal(true);\r\n                            }}\r\n                            className=\"text-primary hover:text-secondary text-sm\"\r\n                          >\r\n                            Sửa\r\n                          </button>\r\n                          <button\r\n                            onClick={() => handleDeleteAddress(address.id)}\r\n                            className=\"text-red-500 hover:text-red-700 text-sm\"\r\n                          >\r\n                            Xóa\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Account Stats */}\r\n          <div className=\"bg-white rounded-lg shadow p-6\">\r\n            <h2 className=\"text-lg font-semibold mb-4\">Thống kê tài khoản</h2>\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n              <div className=\"text-center\">\r\n                <div className=\"text-2xl font-bold text-primary\">\r\n                  {userType === 'seller' ? user?.total_products || 0 : '12'}\r\n                </div>\r\n                <div className=\"text-sm text-gray-500\">\r\n                  {userType === 'seller' ? 'Sản phẩm' : 'Đơn hàng'}\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"text-center\">\r\n                <div className=\"text-2xl font-bold text-green-600\">\r\n                  {userType === 'seller' ? user?.total_sold || 0 : '8'}\r\n                </div>\r\n                <div className=\"text-sm text-gray-500\">\r\n                  {userType === 'seller' ? 'Đã bán' : 'Hoàn thành'}\r\n                </div>\r\n              </div>\r\n              \r\n              <div className=\"text-center\">\r\n                <div className=\"text-2xl font-bold text-yellow-600\">\r\n                  {user?.rating || '0.0'}\r\n                </div>\r\n                <div className=\"text-sm text-gray-500\">Đánh giá</div>\r\n              </div>\r\n              \r\n              <div className=\"text-center\">\r\n                <div className=\"text-2xl font-bold text-blue-600\">\r\n                  {Math.floor((new Date() - new Date(user?.created_at)) / (1000 * 60 * 60 * 24)) || 0}\r\n                </div>\r\n                <div className=\"text-sm text-gray-500\">Ngày tham gia</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Address Modal */}\r\n      <Modal\r\n        isOpen={showAddressModal}\r\n        onClose={() => {\r\n          setShowAddressModal(false);\r\n          setEditingAddress(null);\r\n          setAddressForm({ address: '', phone: '', is_default: false });\r\n        }}\r\n        title={editingAddress ? 'Sửa địa chỉ' : 'Thêm địa chỉ mới'}\r\n      >\r\n        <form onSubmit={handleAddressSubmit} className=\"space-y-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Địa chỉ *\r\n            </label>\r\n            <textarea\r\n              required\r\n              value={addressForm.address}\r\n              onChange={(e) => setAddressForm({...addressForm, address: e.target.value})}\r\n              rows={3}\r\n              className=\"input-field\"\r\n              placeholder=\"Nhập địa chỉ đầy đủ...\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              Số điện thoại *\r\n            </label>\r\n            <input\r\n              type=\"tel\"\r\n              required\r\n              value={addressForm.phone}\r\n              onChange={(e) => setAddressForm({...addressForm, phone: e.target.value})}\r\n              className=\"input-field\"\r\n              placeholder=\"Nhập số điện thoại\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex items-center\">\r\n            <input\r\n              type=\"checkbox\"\r\n              id=\"is_default\"\r\n              checked={addressForm.is_default}\r\n              onChange={(e) => setAddressForm({...addressForm, is_default: e.target.checked})}\r\n              className=\"h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded\"\r\n            />\r\n            <label htmlFor=\"is_default\" className=\"ml-2 text-sm text-gray-700\">\r\n              Đặt làm địa chỉ mặc định\r\n            </label>\r\n          </div>\r\n\r\n          <div className=\"flex space-x-3 pt-4\">\r\n            <button type=\"submit\" className=\"btn-primary flex-1\">\r\n              {editingAddress ? 'Cập nhật' : 'Thêm địa chỉ'}\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setShowAddressModal(false)}\r\n              className=\"btn-secondary flex-1\"\r\n            >\r\n              Hủy\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </Modal>\r\n\r\n      {/* Signature Details Modal */}\r\n      <Modal\r\n        isOpen={showSignatureModal}\r\n        onClose={() => setShowSignatureModal(false)}\r\n        title=\"Chi tiết chữ ký số Dilithium\"\r\n        size=\"large\"\r\n      >\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n            <h4 className=\"font-semibold text-green-800 mb-2\">\r\n              ✅ Chữ ký số đã được thiết lập\r\n            </h4>\r\n            <div className=\"text-sm text-green-700 space-y-1\">\r\n              <div>Thuật toán: {user?.signature_algorithm}</div>\r\n              <div>Variant: {user?.dilithium_variant}</div>\r\n              <div>Kháng lượng tử: {user?.quantum_resistant ? 'Có' : 'Không'}</div>\r\n              <div>Trạng thái: {user?.is_signature_verified ? 'Đã xác minh' : 'Chưa xác minh'}</div>\r\n            </div>\r\n          </div>\r\n\r\n          {signatureData && (\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Public Key (Khóa công khai)\r\n                </label>\r\n                <textarea\r\n                  value={signatureData.public_key}\r\n                  readOnly\r\n                  rows={4}\r\n                  className=\"input-field font-mono text-xs bg-gray-50\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\r\n                <h5 className=\"font-semibold text-yellow-800 mb-2\">⚠️ Lưu ý quan trọng</h5>\r\n                <ul className=\"text-sm text-yellow-700 space-y-1\">\r\n                  <li>• Private key đã được mã hóa và lưu trữ an toàn</li>\r\n                  <li>• Không chia sẻ private key với bất kỳ ai</li>\r\n                  <li>• Sao lưu khóa riêng ở nơi an toàn</li>\r\n                  <li>• Chữ ký số này sẽ được dùng để xác thực các giao dịch</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"flex justify-end\">\r\n            <button\r\n              onClick={() => setShowSignatureModal(false)}\r\n              className=\"btn-primary\"\r\n            >\r\n              Đóng\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProfilePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}